
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ElastoHydrodynamicSolver module &#8212; PyFrac 1.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyFrac 1.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-ElastoHydrodynamicSolver">
<span id="elastohydrodynamicsolver-module"></span><h1>ElastoHydrodynamicSolver module<a class="headerlink" href="#module-ElastoHydrodynamicSolver" title="Permalink to this headline">¶</a></h1>
<p>This file is part of PyFrac.</p>
<p>Created by Haseeb Zia on Wed Dec 28 14:43:38 2016.
Copyright (c) “ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE, Switzerland, Geo-Energy Laboratory”, 2016-2019. All rights reserved.
See the LICENSE.TXT file for more details.</p>
<dl class="function">
<dt id="ElastoHydrodynamicSolver.Elastohydrodynamic_ResidualFun">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">Elastohydrodynamic_ResidualFun</code><span class="sig-paren">(</span><em>solk</em>, <em>system_func</em>, <em>*args</em>, <em>interItr=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#Elastohydrodynamic_ResidualFun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.Elastohydrodynamic_ResidualFun" title="Permalink to this definition">¶</a></dt>
<dd><p>This function gives the residual of the solution for the system of equations formed using the given function.</p>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.FiniteDiff_operator_turbulent_implicit">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">FiniteDiff_operator_turbulent_implicit</code><span class="sig-paren">(</span><em>w</em>, <em>EltCrack</em>, <em>mu</em>, <em>Mesh</em>, <em>InCrack</em>, <em>rho</em>, <em>vkm1</em>, <em>C</em>, <em>sigma0</em>, <em>dgrain</em>, <em>to_solve</em>, <em>active</em>, <em>to_impose</em>, <em>sparse_flag=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#FiniteDiff_operator_turbulent_implicit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.FiniteDiff_operator_turbulent_implicit" title="Permalink to this definition">¶</a></dt>
<dd><p>The function evaluate the finite difference matrix, i.e. the A matrix in the ElastoHydrodynamic equations ( see e.g.
Dontsov and Peirce 2008). The matrix is evaluated by taking turbulence into account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>w</strong> (<em>ndarray</em>) – – the width of the trial fracture.</li>
<li><strong>EltCrack</strong> (<em>ndarray</em>) – – the list of elements inside the fracture</li>
<li><strong>mu</strong> (<em>ndarray</em>) – – the local viscosity of the injected fluid</li>
<li><strong>Mesh</strong> (<a class="reference internal" href="CartesianMesh.html#CartesianMesh.CartesianMesh" title="CartesianMesh.CartesianMesh"><em>CartesianMesh</em></a>) – – the mesh.</li>
<li><strong>InCrack</strong> (<em>ndarray</em>) – – an array specifying whether elements are inside the fracture or not with
1 or 0 respectively.</li>
<li><strong>vkm1</strong> (<em>ndarray</em>) – – the velocity at cell edges from the previous iteration (if necessary). Here,
it is used as the starting guess for the implicit solver.</li>
<li><strong>C</strong> (<em>ndarray</em>) – – the elasticity matrix.</li>
<li><strong>sigma0</strong> (<em>ndarrray</em>) – – the confining stress.</li>
<li><strong>dgrain</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – – the grain size. Used to get the relative roughness.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>FinDiffOprtr (ndarray)    – the finite difference matrix.</li>
<li>vk (ndarray)              – the velocity evaluated for current iteration.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.Gravity_term">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">Gravity_term</code><span class="sig-paren">(</span><em>w</em>, <em>EltCrack</em>, <em>muPrime</em>, <em>Mesh</em>, <em>InCrack</em>, <em>density</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#Gravity_term"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.Gravity_term" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the gravity term (G in Zia and Lecampion 2019).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>w</strong> (<em>ndarray</em>) – – the width of the trial fracture.</li>
<li><strong>EltCrack</strong> (<em>ndarray</em>) – – the list of elements inside the fracture.</li>
<li><strong>muPrime</strong> (<em>ndarray</em>) – – the scaled local viscosity of the injected fluid (12 * viscosity)</li>
<li><strong>Mesh</strong> (<a class="reference internal" href="CartesianMesh.html#CartesianMesh.CartesianMesh" title="CartesianMesh.CartesianMesh"><em>CartesianMesh</em></a>) – – the mesh.</li>
<li><strong>InCrack</strong> (<em>ndarray</em>) – – An array specifying whether elements are inside the fracture or not with
1 or 0 respectively.</li>
<li><strong>density</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – – the density of the fluid.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">– the matrix with the gravity terms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">G (ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.Jacobian">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">Jacobian</code><span class="sig-paren">(</span><em>Residual_function</em>, <em>x</em>, <em>TypValue</em>, <em>*args</em>, <em>central=False</em>, <em>interItr=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#Jacobian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.Jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the Jacobian of the given function.</p>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.MakeEquationSystem_ViscousFluid">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">MakeEquationSystem_ViscousFluid</code><span class="sig-paren">(</span><em>solk</em>, <em>interItr</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#MakeEquationSystem_ViscousFluid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.MakeEquationSystem_ViscousFluid" title="Permalink to this definition">¶</a></dt>
<dd><p>This function makes the linearized system of equations to be solved by a linear system solver. The system is
assembled with the extended footprint (treating the channel and the extended tip elements distinctly; see
description of the ILSA algorithm) as of the last time step. The cells where width constraint is active are solved
for traction and pressure separately.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sol_k</strong> (<em>ndarray</em>) – – the trial change in width and pressure for the current iteration of
fracture front.</li>
<li><strong>interItr</strong> (<em>ndarray</em>) – – the information from the last iteration.</li>
<li><strong>args</strong> (<em>tupple</em>) – <p>– arguments passed to the function. A tuple containing the following in order:</p>
<ul>
<li>EltChannel (ndarray)          – list of channel elements</li>
<li>EltsTipNew (ndarray)          – list of new tip elements. This list also contains the elements that has                                                 been fully traversed.</li>
<li>wLastTS (ndarray)             – fracture width from the last time step.</li>
<li>wTip (ndarray)                – fracture width in the tip elements.</li>
<li>EltCrack (ndarray)            – list of elements in the fracture.</li>
<li>Mesh (CartesianMesh object):  – the mesh.</li>
<li>dt (float)                    – the current time step.</li>
<li>Q (float)                     – fluid injection rate at the current time step.</li>
<li>C (ndarray)                   – the elasticity matrix.</li>
<li>muPrime (ndarray)             – 12 time viscosity of the injected fluid.</li>
<li>rho (float)                   – density of the injected fluid.</li>
<li>InCrack (ndarray)             – an array with one for all the elements in the fracture and zero for rest.</li>
<li>LeakOff (ndarray)             – the leaked off fluid volume for each cell.</li>
<li>sigma0 (ndarray)              – the confining stress.</li>
<li>turb (boolean)                – turbulence will be taken into account if true.</li>
<li>dgrain (float)                – the grain size of the rock. it will be used to calculate the fracture                                               roughness.</li>
<li>active (ndarray)              – index of cells where the width constraint is active.</li>
<li>wc_to_impose (ndarray)        – the critical minimum width to be imposed in the active width constraint                                                cells.</li>
<li>wc (float)                    – the critical minimum width for the material.</li>
<li>cf (float)                    – fluid compressibility.</li>
<li>neiInCrack (ndarray)          – an ndarray giving indices(in the EltCrack list) of the neighbours of all                                               the cells in the crack.</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>A (ndarray)            – the A matrix (in the system Ax=b) to be solved by a linear system solver.</li>
<li>S (ndarray)            – the b vector (in the system Ax=b) to be solved by a linear system solver.</li>
<li>interItr_kp1 (tuple)   – the information transferred between iterations.</li>
<li>indices (list)         – the list containing 3 arrays giving indices of the cells where the solution is                                    obtained for channel, tip and active width constraint cells.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.MakeEquationSystem_ViscousFluid_pressure_substituted">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">MakeEquationSystem_ViscousFluid_pressure_substituted</code><span class="sig-paren">(</span><em>solk</em>, <em>interItr</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#MakeEquationSystem_ViscousFluid_pressure_substituted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.MakeEquationSystem_ViscousFluid_pressure_substituted" title="Permalink to this definition">¶</a></dt>
<dd><p>This function makes the linearized system of equations to be solved by a linear system solver. The system is
assembled with the extended footprint (treating the channel and the extended tip elements distinctly; see
description of the ILSA algorithm). The pressure in the tip cells and the cells where width constraint is active
are solved separately. The pressure in the channel cells to be solved for change in width is substituted with width
using the elasticity relation (see Zia and Lecampion 2019).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sol_k</strong> (<em>ndarray</em>) – – the trial change in width and pressure for the current iteration of
fracture front.</li>
<li><strong>interItr</strong> (<em>ndarray</em>) – – the information from the last iteration.</li>
<li><strong>args</strong> (<em>tupple</em>) – <p>– arguments passed to the function. A tuple containing the following in order:</p>
<ul>
<li>EltChannel (ndarray)          – list of channel elements</li>
<li>EltsTipNew (ndarray)          – list of new tip elements. This list also contains the elements that has                                                 been fully traversed.</li>
<li>wLastTS (ndarray)             – fracture width from the last time step.</li>
<li>wTip (ndarray)                – fracture width in the tip elements.</li>
<li>EltCrack (ndarray)            – list of elements in the fracture.</li>
<li>Mesh (CartesianMesh object):  – the mesh.</li>
<li>dt (float)                    – the current time step.</li>
<li>Q (float)                     – fluid injection rate at the current time step.</li>
<li>C (ndarray)                   – the elasticity matrix.</li>
<li>muPrime (ndarray)             – 12 time viscosity of the injected fluid.</li>
<li>rho (float)                   – density of the injected fluid.</li>
<li>InCrack (ndarray)             – an array with one for all the elements in the fracture and zero for rest.</li>
<li>LeakOff (ndarray)             – the leaked off fluid volume for each cell.</li>
<li>sigma0 (ndarray)              – the confining stress.</li>
<li>turb (boolean)                – turbulence will be taken into account if true.</li>
<li>dgrain (float)                – the grain size of the rock. it will be used to calculate the fracture                                               roughness.</li>
<li>active (ndarray)              – index of cells where the width constraint is active.</li>
<li>wc_to_impose (ndarray)        – the critical minimum width to be imposed in the active width constraint                                                cells.</li>
<li>wc (float)                    – the critical minimum width for the material.</li>
<li>cf (float)                    – fluid compressibility.</li>
<li>neiInCrack (ndarray)          – an ndarray giving indices(in the EltCrack list) of the neighbours of all                                               the cells in the crack.</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>A (ndarray)            – the A matrix (in the system Ax=b) to be solved by a linear system solver.</li>
<li>S (ndarray)            – the b vector (in the system Ax=b) to be solved by a linear system solver.</li>
<li>interItr_kp1 (tuple)   – the information transferred between iterations.</li>
<li>indices (list)         – the list containing 3 arrays giving indices of the cells where the solution is                                    obtained for channel, tip and active width constraint cells.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.MakeEquationSystem_ViscousFluid_pressure_substituted_deltaP">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">MakeEquationSystem_ViscousFluid_pressure_substituted_deltaP</code><span class="sig-paren">(</span><em>solk</em>, <em>interItr</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#MakeEquationSystem_ViscousFluid_pressure_substituted_deltaP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.MakeEquationSystem_ViscousFluid_pressure_substituted_deltaP" title="Permalink to this definition">¶</a></dt>
<dd><p>This function makes the linearized system of equations to be solved by a linear system solver. The system is
assembled with the extended footprint (treating the channel and the extended tip elements distinctly; see
description of the ILSA algorithm). The change is pressure in the tip cells and the cells where width constraint is
active are solved separately. The pressure in the channel cells to be solved for change in width is substituted
with width using the elasticity relation (see Zia and Lecamption 2019).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sol_k</strong> (<em>ndarray</em>) – – the trial change in width and pressure for the current iteration of
fracture front.</li>
<li><strong>interItr</strong> (<em>ndarray</em>) – – the information from the last iteration.</li>
<li><strong>args</strong> (<em>tupple</em>) – <p>– arguments passed to the function. A tuple containing the following in order:</p>
<ul>
<li>EltChannel (ndarray)          – list of channel elements</li>
<li>EltsTipNew (ndarray)          – list of new tip elements. This list also contains the elements that has                                                 been fully traversed.</li>
<li>wLastTS (ndarray)             – fracture width from the last time step.</li>
<li>wTip (ndarray)                – fracture width in the tip elements.</li>
<li>EltCrack (ndarray)            – list of elements in the fracture.</li>
<li>Mesh (CartesianMesh object):  – the mesh.</li>
<li>dt (float)                    – the current time step.</li>
<li>Q (float)                     – fluid injection rate at the current time step.</li>
<li>C (ndarray)                   – the elasticity matrix.</li>
<li>muPrime (ndarray)             – 12 time viscosity of the injected fluid.</li>
<li>rho (float)                   – density of the injected fluid.</li>
<li>InCrack (ndarray)             – an array with one for all the elements in the fracture and zero for rest.</li>
<li>LeakOff (ndarray)             – the leaked off fluid volume for each cell.</li>
<li>sigma0 (ndarray)              – the confining stress.</li>
<li>turb (boolean)                – turbulence will be taken into account if true.</li>
<li>dgrain (float)                – the grain size of the rock. it will be used to calculate the fracture                                               roughness.</li>
<li>active (ndarray)              – index of cells where the width constraint is active.</li>
<li>wc_to_impose (ndarray)        – the critical minimum width to be imposed in the active width constraint                                                cells.</li>
<li>wc (float)                    – the critical minimum width for the material.</li>
<li>cf (float)                    – fluid compressibility.</li>
<li>neiInCrack (ndarray)          – an ndarray giving indices(in the EltCrack list) of the neighbours of all                                               the cells in the crack.</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>A (ndarray)            – the A matrix (in the system Ax=b) to be solved by a linear system solver.</li>
<li>S (ndarray)            – the b vector (in the system Ax=b) to be solved by a linear system solver.</li>
<li>interItr_kp1 (tuple)   – the information transferred between iterations.</li>
<li>indices (list)         – the list containing 3 arrays giving indices of the cells where the solution is                                    obtained for channel, tip and active width constraint cells.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.MakeEquationSystem_ViscousFluid_pressure_substituted_deltaP_sparse">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">MakeEquationSystem_ViscousFluid_pressure_substituted_deltaP_sparse</code><span class="sig-paren">(</span><em>solk</em>, <em>interItr</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#MakeEquationSystem_ViscousFluid_pressure_substituted_deltaP_sparse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.MakeEquationSystem_ViscousFluid_pressure_substituted_deltaP_sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>This function makes the linearized system of equations to be solved by a linear system solver. The system is
assembled with the extended footprint (treating the channel and the extended tip elements distinctly; see
description of the ILSA algorithm). The change is pressure in the tip cells and the cells where width constraint is
active are solved separately. The pressure in the channel cells to be solved for change in width is substituted
with width using the elasticity relation (see Zia and Lecamption 2019). The finite difference difference operator
is saved as a sparse matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sol_k</strong> (<em>ndarray</em>) – – the trial change in width and pressure for the current iteration of
fracture front.</li>
<li><strong>interItr</strong> (<em>ndarray</em>) – – the information from the last iteration.</li>
<li><strong>args</strong> (<em>tupple</em>) – <p>– arguments passed to the function. A tuple containing the following in order:</p>
<ul>
<li>EltChannel (ndarray)          – list of channel elements</li>
<li>EltsTipNew (ndarray)          – list of new tip elements. This list also contains the elements that has                                                 been fully traversed.</li>
<li>wLastTS (ndarray)             – fracture width from the last time step.</li>
<li>wTip (ndarray)                – fracture width in the tip elements.</li>
<li>EltCrack (ndarray)            – list of elements in the fracture.</li>
<li>Mesh (CartesianMesh object):  – the mesh.</li>
<li>dt (float)                    – the current time step.</li>
<li>Q (float)                     – fluid injection rate at the current time step.</li>
<li>C (ndarray)                   – the elasticity matrix.</li>
<li>muPrime (ndarray)             – 12 time viscosity of the injected fluid.</li>
<li>rho (float)                   – density of the injected fluid.</li>
<li>InCrack (ndarray)             – an array with one for all the elements in the fracture and zero for rest.</li>
<li>LeakOff (ndarray)             – the leaked off fluid volume for each cell.</li>
<li>sigma0 (ndarray)              – the confining stress.</li>
<li>turb (boolean)                – turbulence will be taken into account if true.</li>
<li>dgrain (float)                – the grain size of the rock. it will be used to calculate the fracture                                               roughness.</li>
<li>active (ndarray)              – index of cells where the width constraint is active.</li>
<li>wc_to_impose (ndarray)        – the critical minimum width to be imposed in the active width constraint                                                cells.</li>
<li>wc (float)                    – the critical minimum width for the material.</li>
<li>cf (float)                    – fluid compressibility.</li>
<li>neiInCrack (ndarray)          – an ndarray giving indices(in the EltCrack list) of the neighbours of all                                               the cells in the crack.</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>A (ndarray)            – the A matrix (in the system Ax=b) to be solved by a linear system solver.</li>
<li>S (ndarray)            – the b vector (in the system Ax=b) to be solved by a linear system solver.</li>
<li>interItr_kp1 (tuple)   – the information transferred between iterations.</li>
<li>indices (list)         – the list containing 3 arrays giving indices of the cells where the solution is                                    obtained for channel, tip and active width constraint cells.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.MakeEquationSystem_ViscousFluid_pressure_substituted_sparse">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">MakeEquationSystem_ViscousFluid_pressure_substituted_sparse</code><span class="sig-paren">(</span><em>solk</em>, <em>interItr</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#MakeEquationSystem_ViscousFluid_pressure_substituted_sparse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.MakeEquationSystem_ViscousFluid_pressure_substituted_sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>This function makes the linearized system of equations to be solved by a linear system solver. The finite difference
difference opertator is saved as a sparse matrix. The system is assembled with the extended footprint (treating the
channel and the extended tip elements distinctly; see description of the ILSA algorithm). The pressure in the tip
cells and the cells where width constraint is active are solved separately. The pressure in the channel cells to be
solved for change in width is substituted with width using the elasticity relation (see Zia and Lecamption 2019).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sol_k</strong> (<em>ndarray</em>) – – the trial change in width and pressure for the current iteration of
fracture front.</li>
<li><strong>interItr</strong> (<em>ndarray</em>) – – the information from the last iteration.</li>
<li><strong>args</strong> (<em>tupple</em>) – <p>– arguments passed to the function. A tuple containing the following in order:</p>
<ul>
<li>EltChannel (ndarray)          – list of channel elements</li>
<li>EltsTipNew (ndarray)          – list of new tip elements. This list also contains the elements that has                                                 been fully traversed.</li>
<li>wLastTS (ndarray)             – fracture width from the last time step.</li>
<li>wTip (ndarray)                – fracture width in the tip elements.</li>
<li>EltCrack (ndarray)            – list of elements in the fracture.</li>
<li>Mesh (CartesianMesh object):  – the mesh.</li>
<li>dt (float)                    – the current time step.</li>
<li>Q (float)                     – fluid injection rate at the current time step.</li>
<li>C (ndarray)                   – the elasticity matrix.</li>
<li>muPrime (ndarray)             – 12 time viscosity of the injected fluid.</li>
<li>rho (float)                   – density of the injected fluid.</li>
<li>InCrack (ndarray)             – an array with one for all the elements in the fracture and zero for rest.</li>
<li>LeakOff (ndarray)             – the leaked off fluid volume for each cell.</li>
<li>sigma0 (ndarray)              – the confining stress.</li>
<li>turb (boolean)                – turbulence will be taken into account if true.</li>
<li>dgrain (float)                – the grain size of the rock. it will be used to calculate the fracture                                               roughness.</li>
<li>active (ndarray)              – index of cells where the width constraint is active.</li>
<li>wc_to_impose (ndarray)        – the critical minimum width to be imposed in the active width constraint                                                cells.</li>
<li>wc (float)                    – the critical minimum width for the material.</li>
<li>cf (float)                    – fluid compressibility.</li>
<li>neiInCrack (ndarray)          – an ndarray giving indices(in the EltCrack list) of the neighbours of all                                               the cells in the crack.</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>A (ndarray)            – the A matrix (in the system Ax=b) to be solved by a linear system solver.</li>
<li>S (ndarray)            – the b vector (in the system Ax=b) to be solved by a linear system solver.</li>
<li>interItr_kp1 (tuple)   – the information transferred between iterations.</li>
<li>indices (list)         – the list containing 3 arrays giving indices of the cells where the solution is                                   obtained for channel, tip and active width constraint cells.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.MakeEquationSystem_mechLoading">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">MakeEquationSystem_mechLoading</code><span class="sig-paren">(</span><em>wTip</em>, <em>EltChannel</em>, <em>EltTip</em>, <em>C</em>, <em>EltLoaded</em>, <em>w_loaded</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#MakeEquationSystem_mechLoading"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.MakeEquationSystem_mechLoading" title="Permalink to this definition">¶</a></dt>
<dd><p>This function makes the linear system of equations to be solved by a linear system solver. The system is assembled
with the extended footprint (treating the channel and the extended tip elements distinctly). The given width is
imposed on the given loaded elements (see Zia and Lecampion 2019).</p>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.MakeEquationSystem_volumeControl">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">MakeEquationSystem_volumeControl</code><span class="sig-paren">(</span><em>w_lst_tmstp</em>, <em>wTip</em>, <em>EltChannel</em>, <em>EltTip</em>, <em>sigma_o</em>, <em>C</em>, <em>dt</em>, <em>Q</em>, <em>ElemArea</em>, <em>lkOff</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#MakeEquationSystem_volumeControl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.MakeEquationSystem_volumeControl" title="Permalink to this definition">¶</a></dt>
<dd><p>This function makes the linear system of equations to be solved by a linear system solver. The system is assembled
with the extended footprint (treating the channel and the extended tip elements distinctly). The the volume of the
fracture is imposed to be equal to the fluid injected into the fracture (see Zia and Lecampion 2019).</p>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.MakeEquationSystem_volumeControl_symmetric">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">MakeEquationSystem_volumeControl_symmetric</code><span class="sig-paren">(</span><em>w_lst_tmstp</em>, <em>wTip_sym</em>, <em>EltChannel_sym</em>, <em>EltTip_sym</em>, <em>C_s</em>, <em>dt</em>, <em>Q</em>, <em>sigma_o</em>, <em>ElemArea</em>, <em>LkOff</em>, <em>vol_weights</em>, <em>sym_elements</em>, <em>dwTip</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#MakeEquationSystem_volumeControl_symmetric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.MakeEquationSystem_volumeControl_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>This function makes the linear system of equations to be solved by a linear system solver. The system is assembled
with the extended footprint (treating the channel and the extended tip elements distinctly). The the volume of the
fracture is imposed to be equal to the fluid injected into the fracture (see Zia and Lecampion 2018).</p>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.Picard_Newton">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">Picard_Newton</code><span class="sig-paren">(</span><em>Res_fun</em>, <em>sys_fun</em>, <em>guess</em>, <em>TypValue</em>, <em>interItr_init</em>, <em>sim_prop</em>, <em>*args</em>, <em>relax=1.0</em>, <em>PicardPerNewton=1000</em>, <em>perf_node=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#Picard_Newton"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.Picard_Newton" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixed Picard Newton solver for nonlinear systems.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Res_fun</strong> (<em>function</em>) – – The function calculating the residual.</li>
<li><strong>sys_fun</strong> (<em>function</em>) – – The function giving the system A, b for the Picard solver to solve the linear system
of the form Ax=b.</li>
<li><strong>guess</strong> (<em>ndarray</em>) – – The initial guess.</li>
<li><strong>TypValue</strong> (<em>ndarray</em>) – – Typical value of the variable to estimate the Epsilon to calculate Jacobian.</li>
<li><strong>interItr_init</strong> (<em>ndarray</em>) – – Initial value of the variable(s) exchanged between the iterations, if any.</li>
<li><strong>relax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – – The relaxation factor.</li>
<li><strong>Tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – – Tolerance.</li>
<li><strong>maxitr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – – Maximum number of iterations.</li>
<li><strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – – arguments given to the residual and systems functions.</li>
<li><strong>PicardPerNewton</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – – For hybrid Picard/Newton solution. Number of picard iterations for every Newton
iteration.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>solk (ndarray)       – solution at the end of iteration.</li>
<li>data (tuple)         – any data to be returned</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.Velocity_Residual">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">Velocity_Residual</code><span class="sig-paren">(</span><em>v</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#Velocity_Residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.Velocity_Residual" title="Permalink to this definition">¶</a></dt>
<dd><p>This function gives the residual of the velocity equation. It is used by the root finder.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – – current velocity guess</li>
<li><strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – <p>– a tuple consisting of the following:</p>
<ul>
<li>w (float)          width at the given cell edge</li>
<li>mu (float)         viscosity at the given cell edge</li>
<li>rho (float)        density of the injected fluid</li>
<li>dp (float)         pressure gradient at the given cell edge</li>
<li>rough (float)      roughness (width / grain size) at the cell center</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">– residual of the velocity equation</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.calculate_fluid_flow_characteristics_laminar">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">calculate_fluid_flow_characteristics_laminar</code><span class="sig-paren">(</span><em>w</em>, <em>C</em>, <em>sigma0</em>, <em>Mesh</em>, <em>EltCrack</em>, <em>InCrack</em>, <em>muPrime</em>, <em>density</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#calculate_fluid_flow_characteristics_laminar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.calculate_fluid_flow_characteristics_laminar" title="Permalink to this definition">¶</a></dt>
<dd><p>This function calculate fluid flux and velocity at the cell edges evaluated with the pressure calculated from the
elasticity relation for the given fracture width and the poisoille’s Law.</p>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.check_covergance">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">check_covergance</code><span class="sig-paren">(</span><em>solk</em>, <em>solkm1</em>, <em>indices</em>, <em>tol</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#check_covergance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.check_covergance" title="Permalink to this definition">¶</a></dt>
<dd><p>This function checks for convergence of the solution</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>solk</strong> (<em>ndarray</em>) – </li>
<li><strong>solkm1</strong> (<em>ndarray</em>) – </li>
<li><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – for channel, tip and active width constraint cells.</li>
<li><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>converged (bool) – True if converged</li>
<li>norm (float)     – the evaluated norm which is checked against tolerance</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.findBracket">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">findBracket</code><span class="sig-paren">(</span><em>func</em>, <em>guess</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#findBracket"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.findBracket" title="Permalink to this definition">¶</a></dt>
<dd><p>This function can be used to find bracket for a root finding algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>func</strong> (<em>callable function</em>) – – the function giving the residual for which zero is to be found</li>
<li><strong>guess</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – – starting guess</li>
<li><strong>args</strong> (<em>tupple</em>) – – arguments passed to the function</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>a (float)                – the lower bracket</li>
<li>b (float)                – the higher bracket</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.finiteDiff_operator_laminar">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">finiteDiff_operator_laminar</code><span class="sig-paren">(</span><em>w</em>, <em>EltCrack</em>, <em>muPrime</em>, <em>Mesh</em>, <em>InCrack</em>, <em>neiInCrack</em>, <em>sparse_flag=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#finiteDiff_operator_laminar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.finiteDiff_operator_laminar" title="Permalink to this definition">¶</a></dt>
<dd><p>The function evaluate the finite difference 5 point stencil matrix, i.e. the A matrix in the ElastoHydrodynamic
equations in e.g. Dontsov and Peirce 2008. The matrix is evaluated with the laminar flow assumption.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>w</strong> (<em>ndarray</em>) – – the width of the trial fracture.</li>
<li><strong>EltCrack</strong> (<em>ndarray</em>) – – the list of elements inside the fracture.</li>
<li><strong>muPrime</strong> (<em>ndarray</em>) – – the scaled local viscosity of the injected fluid (12 * viscosity).</li>
<li><strong>Mesh</strong> (<a class="reference internal" href="CartesianMesh.html#CartesianMesh.CartesianMesh" title="CartesianMesh.CartesianMesh"><em>CartesianMesh</em></a>) – – the mesh.</li>
<li><strong>InCrack</strong> (<em>ndarray</em>) – – an array specifying whether elements are inside the fracture or not with
1 or 0 respectively.</li>
<li><strong>neiInCrack</strong> (<em>ndarray</em>) – – an ndarray giving indices of the neighbours of all the cells in the crack, in the
EltCrack list.</li>
<li><strong>sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – – if true, the finite difference operator will be given as a sparse matrix.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">– the finite difference matrix.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">FinDiffOprtr (ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.pressure_gradient">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">pressure_gradient</code><span class="sig-paren">(</span><em>w</em>, <em>C</em>, <em>sigma0</em>, <em>Mesh</em>, <em>EltCrack</em>, <em>InCrack</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#pressure_gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.pressure_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>This function gives the pressure gradient at the cell edges evaluated with the pressure calculated from the
elasticity relation for the given fracture width.</p>
</dd></dl>

<dl class="function">
<dt id="ElastoHydrodynamicSolver.velocity">
<code class="descclassname">ElastoHydrodynamicSolver.</code><code class="descname">velocity</code><span class="sig-paren">(</span><em>w</em>, <em>EltCrack</em>, <em>Mesh</em>, <em>InCrack</em>, <em>muPrime</em>, <em>C</em>, <em>sigma0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ElastoHydrodynamicSolver.html#velocity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ElastoHydrodynamicSolver.velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>This function gives the velocity at the cell edges evaluated using the Poiseuille flow assumption.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/doc_src/ElastoHydrodynamicSolver.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyFrac 1.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Haseeb Zia.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>